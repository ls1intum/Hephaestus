{
  "$schema": "https://docs.renovatebot.com/renovate-schema.json",
  "description": "Renovate configuration for Hephaestus monorepo",
  "extends": [
    "config:best-practices",
    ":semanticCommits",
    ":separateMajorReleases",
    ":separateMultipleMajorReleases"
  ],
  "labels": [
    "dependencies"
  ],
  "assigneesFromCodeOwners": true,
  "prHourlyLimit": 4,
  "prConcurrentLimit": 10,
  "branchConcurrentLimit": 15,
  "rebaseWhen": "conflicted",
  "platformAutomerge": true,
  "automergeType": "pr",
  "automergeStrategy": "squash",
  "semanticCommitScope": "deps",
  "semanticCommitType": "chore",
  "commitMessageLowerCase": "auto",
  "prTitleStrict": true,
  "dependencyDashboardTitle": "ðŸ”„ Dependency Dashboard",
  "dependencyDashboardLabels": [
    "dependencies"
  ],
  "configWarningReuseIssue": false,
  "timezone": "Europe/Berlin",
  "schedule": [
    "before 9am on Monday"
  ],
  "prBodyColumns": [
    "Package",
    "Type",
    "Update",
    "Change",
    "Age"
  ],
  "prBodyNotes": [
    "ðŸ“¦ This PR was auto-generated by [Renovate](https://renovatebot.com).",
    "Review the changes, ensure CI passes, then merge."
  ],
  "postUpdateOptions": [
    "npmDedupe"
  ],
  "vulnerabilityAlerts": {
    "labels": [
      "security",
      "dependencies"
    ],
    "schedule": [
      "at any time"
    ],
    "minimumReleaseAge": null,
    "prPriority": 10,
    "automerge": false
  },
  "lockFileMaintenance": {
    "enabled": true,
    "schedule": [
      "before 9am on Monday"
    ],
    "automerge": true
  },
  "packageRules": [
    {
      "description": "Automerge patch updates after stability check",
      "matchUpdateTypes": [
        "patch"
      ],
      "automerge": true,
      "minimumReleaseAge": "3 days",
      "internalChecksFilter": "strict"
    },
    {
      "description": "Automerge minor updates after longer stability check",
      "matchUpdateTypes": [
        "minor"
      ],
      "automerge": true,
      "minimumReleaseAge": "7 days",
      "internalChecksFilter": "strict"
    },
    {
      "description": "Major updates require dashboard approval",
      "matchUpdateTypes": [
        "major"
      ],
      "dependencyDashboardApproval": true,
      "labels": [
        "dependencies",
        "breaking"
      ],
      "automerge": false,
      "minimumReleaseAge": "14 days"
    },
    {
      "description": "Application Server (Java/Spring)",
      "matchManagers": [
        "maven"
      ],
      "groupName": "Java dependencies",
      "labels": [
        "dependencies",
        "application-server"
      ]
    },
    {
      "description": "Intelligence Service (TypeScript)",
      "matchManagers": [
        "npm"
      ],
      "matchFileNames": [
        "server/intelligence-service/**"
      ],
      "groupName": "Intelligence Service dependencies",
      "labels": [
        "dependencies",
        "intelligence-service"
      ]
    },
    {
      "description": "Webhook Ingest (TypeScript)",
      "matchManagers": [
        "npm"
      ],
      "matchFileNames": [
        "server/webhook-ingest/**"
      ],
      "groupName": "Webhook Ingest dependencies",
      "labels": [
        "dependencies",
        "webhook-ingest"
      ]
    },
    {
      "description": "Webapp dependencies",
      "matchFileNames": [
        "webapp/package.json"
      ],
      "groupName": "Webapp dependencies",
      "labels": [
        "dependencies",
        "webapp"
      ]
    },
    {
      "description": "Documentation dependencies",
      "matchFileNames": [
        "docs/package.json"
      ],
      "groupName": "Documentation dependencies",
      "labels": [
        "dependencies",
        "documentation"
      ]
    },
    {
      "description": "Root monorepo tooling",
      "matchFileNames": [
        "package.json"
      ],
      "groupName": "Root tooling",
      "labels": [
        "dependencies"
      ]
    },
    {
      "description": "Spring Boot framework - keep aligned",
      "groupName": "Spring Boot",
      "matchPackageNames": [
        "/^org\\.springframework/"
      ]
    },
    {
      "description": "React ecosystem",
      "matchPackageNames": [
        "react",
        "react-dom",
        "@tanstack/**"
      ],
      "groupName": "React ecosystem"
    },
    {
      "description": "Testing libraries (webapp) - pinned to Vitest 3.x for Storybook compatibility",
      "matchPackageNames": [
        "@testing-library/**",
        "vitest",
        "@vitest/**"
      ],
      "matchFileNames": [
        "webapp/package.json"
      ],
      "groupName": "Webapp testing libraries",
      "allowedVersions": "<4.0.0",
      "prBodyNotes": [
        "âš ï¸ Webapp uses Vitest 3.x due to @storybook/experimental-addon-test peer dependency (requires vitest ^2.1.1 || ^3.0.0)"
      ]
    },
    {
      "description": "Testing libraries (services) - can use latest Vitest",
      "matchPackageNames": [
        "vitest",
        "@vitest/**"
      ],
      "matchFileNames": [
        "server/intelligence-service/**",
        "server/webhook-ingest/**"
      ],
      "groupName": "Service testing libraries"
    },
    {
      "description": "Playwright",
      "matchPackageNames": [
        "playwright",
        "@playwright/**"
      ],
      "groupName": "Playwright"
    },
    {
      "description": "Build tools",
      "matchPackageNames": [
        "typescript",
        "vite",
        "@vitejs/**",
        "esbuild"
      ],
      "groupName": "Build tools"
    },
    {
      "description": "Linting and formatting",
      "matchPackageNames": [
        "@biomejs/**",
        "prettier",
        "prettier-plugin-**"
      ],
      "groupName": "Linting and formatting"
    },
    {
      "description": "OpenAPI tooling",
      "matchPackageNames": [
        "@openapitools/**",
        "@hey-api/**"
      ],
      "groupName": "OpenAPI tools"
    },
    {
      "description": "AI SDK ecosystem - keep aligned across services",
      "matchPackageNames": [
        "ai",
        "@ai-sdk/**"
      ],
      "groupName": "AI SDK"
    },
    {
      "description": "Hono framework - keep aligned across services",
      "matchPackageNames": [
        "hono",
        "@hono/**"
      ],
      "groupName": "Hono framework"
    },
    {
      "description": "Zod (webapp) - pinned to 3.x for TanStack compatibility",
      "matchPackageNames": [
        "zod"
      ],
      "matchFileNames": [
        "webapp/package.json"
      ],
      "allowedVersions": "<4.0.0",
      "prBodyNotes": [
        "âš ï¸ Webapp uses Zod 3.x due to @tanstack/zod-adapter peer dependency (requires zod@^3.23.8)"
      ]
    },
    {
      "description": "Zod (services) - can use latest Zod 4.x",
      "matchPackageNames": [
        "zod"
      ],
      "matchFileNames": [
        "server/intelligence-service/**",
        "server/webhook-ingest/**"
      ],
      "groupName": "Service Zod"
    },
    {
      "description": "Shared workspace tooling - keep aligned",
      "matchPackageNames": [
        "@types/node",
        "tsx",
        "pino",
        "pino-pretty",
        "dotenv"
      ],
      "groupName": "Shared workspace tooling"
    },
    {
      "description": "GitHub Actions - automerge after CI",
      "matchManagers": [
        "github-actions"
      ],
      "groupName": "GitHub Actions",
      "automerge": true,
      "labels": [
        "dependencies",
        "ci"
      ]
    },
    {
      "description": "Docker images (Dockerfiles and compose)",
      "matchManagers": [
        "dockerfile",
        "docker-compose"
      ],
      "groupName": "Docker images",
      "labels": [
        "dependencies",
        "infrastructure"
      ]
    },
    {
      "description": "Node.js version - manual review",
      "matchDepNames": [
        "node"
      ],
      "matchManagers": [
        "nodenv"
      ],
      "automerge": false,
      "labels": [
        "dependencies",
        "infrastructure"
      ]
    },
    {
      "description": "Postgres major version - manual review",
      "matchPackageNames": [
        "postgres"
      ],
      "matchUpdateTypes": [
        "major"
      ],
      "automerge": false,
      "dependencyDashboardApproval": true,
      "labels": [
        "dependencies",
        "infrastructure",
        "breaking"
      ]
    }
  ],
  "ignorePaths": [
    "**/node_modules/**",
    "**/target/**",
    "**/.venv/**",
    "**/dist/**",
    "**/build/**"
  ]
}
