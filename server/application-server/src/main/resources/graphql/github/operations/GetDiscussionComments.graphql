# GraphQL query for fetching additional discussion comments (pagination)
# Used when a discussion has more than 10 comments (follow-up to GetRepositoryDiscussions)

query GetDiscussionComments($owner: String!, $name: String!, $discussionNumber: Int!, $first: Int!, $after: String) {
    rateLimit {
        cost
        limit
        remaining
        resetAt
    }
    repository(owner: $owner, name: $name) {
        discussion(number: $discussionNumber) {
            id
            comments(first: $first, after: $after) {
                totalCount
                pageInfo {
                    hasNextPage
                    endCursor
                }
                nodes {
                    ...DiscussionCommentFields

                    # Reply to (for threading)
                    replyTo {
                        id
                    }

                    # Replies to this comment
                    replies(first: 100) {
                        totalCount
                        pageInfo {
                            hasNextPage
                            endCursor
                        }
                        nodes {
                            ...DiscussionCommentFields
                        }
                    }
                }
            }
        }
    }
}
