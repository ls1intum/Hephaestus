# Follow-up pagination query for pull request project items.
# Used when a PR has more than 5 project items (embedded inline limit).
# This query fetches additional project items starting from a cursor.

query GetPullRequestProjectItems($pullRequestId: ID!, $first: Int!, $after: String) {
    rateLimit {
        cost
        limit
        remaining
        resetAt
    }
    node(id: $pullRequestId) {
        ... on PullRequest {
            id
            fullDatabaseId
            number
            projectItems(first: $first, after: $after, includeArchived: true) {
                totalCount
                pageInfo {
                    hasNextPage
                    endCursor
                }
                nodes {
                    id
                    fullDatabaseId
                    type
                    isArchived
                    createdAt
                    updatedAt

                    # Project reference - needed to link item to correct project
                    project {
                        ...ProjectV2RefFields
                    }

                    # Field values (embedded, first 10)
                    # Uses shared FieldValueFieldsCostOptimized fragment (all 11 field value types)
                    fieldValues(first: 10) {
                        totalCount
                        pageInfo {
                            hasNextPage
                            endCursor
                        }
                        nodes {
                            ...FieldValueFieldsCostOptimized
                        }
                    }
                }
            }
        }
    }
}
