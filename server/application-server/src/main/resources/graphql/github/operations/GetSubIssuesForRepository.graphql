# GraphQL operation for syncing sub-issues across a repository
# Used by GitHubSubIssueSyncService via documentName("GetSubIssuesForRepository")
#
# Returns issues with their parent relationships and sub_issues_summary for efficient bulk sync.
# Uses GitHub's GraphQL API for sub-issues feature (2024).

query GetSubIssuesForRepository(
	$owner: String!
	$name: String!
	$first: Int!
	$after: String
) {
	repository(owner: $owner, name: $name) {
		issues(first: $first, after: $after, filterBy: { states: [OPEN, CLOSED] }) {
			pageInfo {
				hasNextPage
				endCursor
			}
			totalCount
			nodes {
				id
				fullDatabaseId
				number
				title
				state
				parent {
					id
					fullDatabaseId
					number
				}
				subIssuesSummary {
					total
					completed
					percentCompleted
				}
			}
		}
	}
}
