# GraphQL query for fetching organization teams
# Used by GraphQL-based sync services

query GetOrganizationTeams($login: String!, $first: Int!, $after: String) {
    rateLimit {
        cost
        limit
        remaining
        resetAt
    }
    organization(login: $login) {
        teams(first: $first, after: $after) {
            pageInfo {
                hasNextPage
                endCursor
            }
            totalCount
            nodes {
                __typename
                id
                databaseId
                slug
                name
                description
                privacy
                url
                createdAt
                updatedAt

                # Team members with roles - uses edges to get role field
                members(first: 100) {
                    totalCount
                    pageInfo {
                        hasNextPage
                        endCursor
                    }
                    edges {
                        role
                        node {
                            __typename
                            id
                            databaseId
                            login
                            avatarUrl
                            name
                        }
                    }
                }

                # Parent team
                parentTeam {
                    __typename
                    id
                    databaseId
                    slug
                    name
                }

                # Repositories with permissions
                repositories(first: 100) {
                    totalCount
                    pageInfo {
                        hasNextPage
                        endCursor
                    }
                    edges {
                        permission
                        node {
                            __typename
                            id
                            databaseId
                            name
                            nameWithOwner
                        }
                    }
                }
            }
        }
    }
}
