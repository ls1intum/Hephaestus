# Follow-up pagination query for issue project items.
# Used when an issue has more than 5 project items (embedded inline limit).
# This query fetches additional project items starting from a cursor.

query GetIssueProjectItems($issueId: ID!, $first: Int!, $after: String) {
    rateLimit {
        cost
        limit
        remaining
        resetAt
    }
    node(id: $issueId) {
        ... on Issue {
            id
            fullDatabaseId
            number
            projectItems(first: $first, after: $after, includeArchived: true) {
                totalCount
                pageInfo {
                    hasNextPage
                    endCursor
                }
                nodes {
                    id
                    fullDatabaseId
                    type
                    isArchived
                    createdAt
                    updatedAt

                    # Project reference - needed to link item to correct project
                    project {
                        ...ProjectV2RefFields
                    }

                    # Field values (embedded, first 20)
                    # Uses shared FieldValueFieldsCostOptimized fragment (all 11 field value types)
                    fieldValues(first: 20) {
                        totalCount
                        pageInfo {
                            hasNextPage
                            endCursor
                        }
                        nodes {
                            ...FieldValueFieldsCostOptimized
                        }
                    }
                }
            }
        }
    }
}
